# 3. 네트워크 통신

## 3.1 유니캐스트, 멀티캐스트, 브로드캐스트, 애니캐스트

- 네트워크에서 출발지에서 목적지로 데이터를 전송할 때 사용하는 통신 방식

  - **유니캐스트**
    - 1 : 1 통신
    - 출발지와 목적지가 1 :1 통신
    - 실제로 사용하는 대부분의 통신 방식
  - **브로드캐스트**
    - 1 : 모든 통신
    - 동일 네트워크에 존재하는 모든 호스트가 목적지
    - 유니캐스트로 통신하기 전, 주로 상대방의 정확한 위치를 알기 위해 사용
    - 기본 동작은 네트워크 내에서 모든 호스트에 패킷을 전달할 때 사용
  - **멀티캐스트**
    - 1 : 그룹(멀티캐스트 구독 호스트) 통신
    - 하나의 출발지에서 다수의 특정 목적지로 데이터 전송
    - 멀티캐스트 그룹 주소를 이용해 해당 그룹에 속한 다수의 호스트로 패킷을 전송하기 위한 통신 방식
    - 단방향으로 다수에게 동시에 같은 내용을 전달해야할 때 사용(IPTV, 사내 방송 등)
  - **애니캐스트**
    - 1 : 1  통신(목적지는 동일 그룹 내의 1개 호스트)
    - 다수의 동일 그룹 중 가장 가까운 호스트에서 응답
    - IPv4에서는 일부 기능 구현, IPv6은 모두 구현 가능
    - 애니캐스트 주소가 같은 호스트들 중에서 가장 가깝거나 가장 효율적으로 서비스 가능한 호스트 통신 방식

  | 타입         | 통신 대상 | 범위                  | IPv4 | IPv6 | 예제       |
  | ------------ | --------- | --------------------- | ---- | ---- | ---------- |
  | 유니캐스트   | 1 : 1     | 전체 네트워크         | O    | O    | HTTP       |
  | 브로드캐스트 | 1 : 모두  | 서브넷(로컬 네트워크) | O    | X    | ARP        |
  | 멀티캐스트   | 1 : 그룹  | 정의된 구간           | O    | O    | 방송       |
  | 애니캐스트   | 1 : 1     | 전체 네트워크         | △    | O    | 6 to 4 DNS |

  - **통신 방식을 구분할 때 중요한 점은 출발지가 기준이 아닌 목적지 주소를 기준으로 구분**

## 3.2 MAC 주소

- Media Access Control의 줄임말로 2계층(데이터 링크)에서 토신을 위해 네트워크 인터페이스에 할당된 고유 식별자

### 3.2.1 MAC 주소 체계

- MAC 주소는 변경 불가능하게 하드웨어에 고정되어 출하되므로 네트워크 구성 요소마다 다른 주소를 가짐
- MAC 주소는 48비트의 16진수 12자리로 표현
  - 앞의 24비트와 뒤의 24비트로 나누어 구분
    - OUI
      - 앞의 24비트인 '제조사 코드'
      - IEEE가 제조사에 할당하는 부분
    - UAA
      - 뒤의 24비트
      - 각 제조사에서 네트워크 구성 요소에 할당하는 부분
- **네트워크 카드나 장비를 생산할 때 하드웨어적으로 정해져 나오므로 MAC 주소를 BIA(Burend-In Address)라고도 부름**

### 3.2.2 MAC 주소 동작

- NIC는 자신의 MAC 주소를 가지고 있고 전기 신호가 들어오면 2계층에서 패킷으로 변환하여 내용을 구분한 후 도착지 MAC 주소 확인
- 만약 도착지 MAC 주소가 자신이 갖고 있는 MAC 주소와 다르면 그 패킷을 폐기
- 패킷의 목적지 주소가 자기 자신이거나 브로드캐스트, 멀티캐스트와 같은 그룹 주소이면 처리해야할 주소로 인지해 패킷 정보를 상위 계층으로 넘김

## 3.3 IP 주소

- IP 주소를 포함한 다른 프로토콜 스택의 3계층 주소의 특성
  - 사용자가 변경 가능한 논리 주소
  - 주소에 레벨이 있음, 그룹을 의미하는 네트워크 주소와 호스트 주소로 나뉨

### 3.3.1 IP 주소 체계

- IP는 v4, v6 두 체계가 사용되며 IPv4 주소는 32비트, IPv6 주소는 128비트
- IPv4 주소를 표기할 때는 4개의 옥텟(Octet)이라고 부르는 8비트 단위로 나누고 각 옥텟은 `.`으로 구분
- 2계층의 MAC 주소가 16진수로 표기된 것과 달리 IP 주소는 10진수로 표기하므로 0 ~ 255의 값 사용 가능
- IP 주소는 **네트워크 주소**와 **호스트 주소** 두 부분으로 나뉨
  - 네트워크 주소
    - 호스트들을 모은 네트워크를 지칭하는 주소
    - 네트워크 주소가 동일한 네트워크를 로컬 네트워크라 함
  - 호스트 주소
    - 하나의 네트워크 내에 존재하는 호스트를 구분하기 위한 주소
- IP주소의 네트워크 주소와 호스트 주소는 구분하는 경계점이 고정되어 있지 않음
- 필요한 호스트 IP 개수에 따라 네트워크의 크기를 다르게 할당 가능한 클래스(Class) 개념 도입
  - A 클래스
    - 첫 번째 옥텟에 구분자를 가지며, 약 1600만 개의 IP 주소를 가질 수 있음
    - 주소 범위: 1~127.0.0.0 
  - B 클래스
    - 두 번째 옥텟에 구분자를 가지며, 약 6만 5천 개의 IP 주소를 가질 수 있음
    - 주소 범위: 128~191.0.0.0
  - C 클래스
    - 세 번째 옥텟에 구분자를 가지며, 약 250 개의 IP 주소를 가질 수 있음
    - 주소 범위: 192~223.0.0.0
  - 이 구분자는 서브넷 마스크라고 함

### 3.3.2 클래스풀과 클래스리스

- 클래스(Class) 기반의 IP 주소 체계를 클래스풀(Classful)이라고 함
- IP 주소 체계를 처음 만들었을 때는 클래스 개념을 도입한 것이 확장성 있고 주소 낭비가 적은 최적의 조건을 만들 수 있었음

#### 3.3.2.1 클래스리스 네트워크의 등장

- 인터넷이 상용화되면서 인터넷에 연결되는 호스트 숫자가 폭발적으로 증가하면서 IP 주소가 부족해짐
- IP 주소 부족과 낭비 문제를 해결하기 위한 3가지 보존, 전환 전략 등장
  - 클래스리스, CIDR(Classless Inter-Domain Routing) 기반 주소 체계
  - NAT와 사설 IP 주소
  - IPv6
- IPv4의 가장 큰 문제는 주소 자체의 부족도 있지만 상위 클래스(A Class)를 할당받은 조직에서 제대로 사용하지 못하면서 낭비하는 것
- 클래스풀에서는 한 개의 클래스 네트워크가 한 조직에 할당되면 아무리 비어 있는 주소라도 IP를 분할해 다른 기관이 사용 불가능
- 이 문제를 해결하기 위해 클래스 개념 자체를 버리는 클래스리스 등장
- 현재 우리가 사용하는 주소 체계는 클래스 개념을 적용하지 않는 클래스리스 기반 주소 체계
- 클래스리스 네트워크에서는 별도로 네트워크와 호스트 주소를 나누는 구분자를 사용하는데 이를 서브넷 마스크라고 함