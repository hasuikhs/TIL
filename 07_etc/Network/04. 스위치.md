# 4. 스위치

> 네트워크의 가장 핵심장비
>
> 2계층 주소인 MAC 주소를 기반으로 동작
>
> 스위치는 네트워크 중간에서 패킷을 받아 필요한 곳에만 보내주는 네트워크의 중재자 역할

## 4.1 스위치 장비 동작

- 스위치는 네트워크에서 통신을 중재하는 장비
  - 스위치가 없던 시절에는 패킷을 전송할 때 서로 경합해 그로 인한 성능 저하가 컷음
  - 이런 경쟁을 없애고 패킷을 동시에 여러 장비가 서로 간섭 없이 통신하도록 도와주는 장비가 스위치
  - 스위치를 사용하면 여러 단말이 한꺼번에 통신 가능해 통신하기 위해 기다리거나 **충돌 때문에 대기하는 문제가 해결되고 네트워크 전체의 통신 효율성이 향상**됨
- 스위치의 핵심 역할은 누가 어느 위치에 있는지 파악하고 실제 통신이 시작되면 자신이 알고 있는 위치로 패킷을 정확히 전송하는 것
  - 이런 동작은 스위치가 2계층 주소를 이해하고 단말의 주소인 MAC 주소와 단말이 위치하는 인터페이스 정보를 매핑한 MAC 주소 테이블을 갖고 있어서 가능
- 스위치는 전송하려는 패킷의 헤더 안에 있는 **2계층 목적지 주소를 확인하고 MAC 주소 테이블에서 해당 주소가 어느 포트에 있는지 확인해 해당 패킷을 그 포트로만 전송**
- 이런 역할을 수행하기 위해 스위치는 MAC 주소와 포트가 매핑된 MAC 주소 테이블이 필요

### 4.1.1 플러딩

- 스위치는 부팅하면 네트워크 관련 정보가 아무것도 없음
  - 이때 스위치는 네트워크 통신을 중재하는 자신의 역할을 하지 못하고 허브처럼 동작
  - **이와 같이 스위치가 허브와 같이 모든 포트로 패킷을 흘리는 동작 방식을 플러딩이라고 함**
- 이런 플러딩 동작은 스위치의 정상적인 동작이지만 많아지면 스위치가 제 역할을 못하게 됨

### 4.1.2 어드레스 러닝

- 스위치가 패킷의 도착지 MAC 주소를 확인하여 원하는 포트로 포워딩하는 스위치의 동작을 정상적으로 수행하려면 MAC 주소 테이블을 만들고 유지해야 함
- MAC 주소 테이블은 어느 위치(포트)에 어떤 장비(MAC 주소)가 연결되었는지에 대한 정보가 저장된 임시 테이블
- **이런 MAC 주소 테이블을 만들고 유지하는 과정을 어드레스 러닝이라 함**

### 4.1.3 포워딩/필터링

- 스위치의 동작은 매우 간단함
  - 패킷이 스위치에 들어온 경우, **MAC 주소를 확인해 자신이 가진 MAC 테이블과 비교해 있으면 해당 포트로 패킷을 포워딩**
  - 이때 **다른 포트로는 해당 패킷을 보내지 않으므로 이 동작을 필터링이라 함**
- 스위치는 이런 포워딩과 필터링을 통해 목적지로만 패킷이 전달되도록 동작
- 스위치에서는 포워딩과 필터링 작업이 여러 포트에서 동시에 수행 가능함
- 통신이 다른 포트에 영향을 미치지 않으므로 다른 포트에서 기존 통신작업으로부터 독립적 동작 가능함

## 4.2 VLAN

### 4.2.1 VLAN ?

- 물리적 배치와 상관없이 LAN을 논리적으로 분할, 구성하는 기술
- 최근에는 전화기, 복합기, 스마트폰과 같이 PC 외에도 다수의 단말이 네트워크에 연결되므로 네트워크 분할이 더 중요
- VLAN을 나누면 하나의 장비를 서로 다른 네트워크를 갖도록 논리적으로 분할한 것
  - 유니캐스트뿐만 아니라 브로드캐스트도 VLAN 간에 통신 불가능함
  - VLA 간의 통신이 필요하다면 서로 다른 네트워크 간의 통신이므로 3계층 장비가 필요

### 4.2.2 VLAN의 종류와 특징

- 포트 기반 VLAN
  - 스위치를 논리적으로 분할해 사용하는 것이 목적인 VLAN
  - 일반적으로 언급하는 대부분의 VLAN
  - 어떤 단말이 접속하든지 스위치의 특정 포트에 VLAN을 할당하면 할당된 VLAN에 속함
- MAC 주소 기반 VLAN
  - 사용자들의 자리 이동이 많아지면서 개발됨
  - 스위치에 연결되는 단말의 MAC 주소를 기반으로 VLAN을 할당하는 기술
  - 단말이 연결되면 단말의 MAC  주소를 인식한 스위치가 해당 포트를 지정한 VLAN으로 변경함
  - 단말에 따라 VLAN  정보가 바뀔  수 있어 Dynamic VLAN이라고도 부름