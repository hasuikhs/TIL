



# OSI 7계층과 TCP/IP

## 1. OSI 7계층

- 과거에는 통신용 규약이 표준화되지 않았고 별도로 개발했기에 호환되지 않는 시스템이나 애플리케이션이 많고 통신이 불가능했음
- 이를 하나의 규약으로 통합하려는 노력이 현재의 OSI 7계층으로 남아있음
- OSI 7계층이 네트워크 동작을 나누어 이해하고 개발하는 데 많은 도움이 되므로 네트워크의 주요 레퍼런스 모델로 활용되고 있지만 현재는 대부분의 프로토콜이 TCP/IP 프로토콜 스택 기반으로 되어 있음

- OSI 7계층은 두 계층으로 나눌 수 있음

  - 1~4계층 : Data Flow Layer / Lower Layer

    - 데이터를 상대방에게 잘 전달하는 역할을 가짐
    - 네트워크 엔지니어가 고려하는 영역

  - 5~7계층 : Application Layer / Upper Layer

    - 애플리케이션 개발자들이 고려하는 영역

    | 계층  | 기본 용어          |      |
    | ----- | ------------------ | ---- |
    | 7계층 | Application Layer  | L7   |
    | 6계층 | Presentation Layer | L6   |
    | 5계층 | Session Layer      | L5   |
    | 4계층 | Transport Layer    | L4   |
    | 3계층 | Network Layer      | L3   |
    | 2계층 | Data Link Layer    | L2   |
    | 1계층 | Physical Layer     | L1   |

  - 애플리케이션 개발자는 하향식(Top-Down) 형식으로 네트워크 엔지니어는 상향식(Bottom-Up) 형식으로 네트워크를 봄

### 1.1 1계층(Physical Layer)

- 물리 계층으로 물리적 연결과 관련된 정보를 정의
- 주로 전기 신호를 전달하는 데 초점
- 주요 장비로는 허브(Hub), 리피터(Repeater), 케이블(Cable), 커넥터(Connector), 트랜시버(Tranceiver), 탭(TAP) 등이 있음
  - 허브, 리피터는 네트워크 통신을 중재하는 네트워크 장비
  - 케이블, 커넥터, 트랜시버는 컴퓨터의 랜 카드와 케이블을 연결하는 장치
  - 탭은 네트워크 모니터링과 패킷 분석을 위해 전기 신호를 다른 장비로 복제해줌
- 1계층에서는 들어온 전기 신호를 그대로 잘 전달하는 것이 목적
  - 전기 신호가 1계층 장비에 들어오면 이 신호를 재생성하여 내보냄
  - 1계층 장비는 주소의 개념이 없으므로 전기 신호가 들어온 포트를 제외하고 모든 포트에 같은 전기 신호를 전송

### 1.2 2계층(Data Link Layer)

- 전기 신호를 모아 우리가 알아볼 수 있는 데이터 형태로 처리
- 1계층과는 다르게 전기 신호를 정확히 전달하기보다는 주소 정보를 정의하고 정확한 주소로 통신이 가능하도록 초점
- 출발지와 도착지 주소를 확인하고 올바르게 보낸 것이 맞는지, 처리해야 하는지에 대해 검사한 후 데이터 처리 수행
- 2계층에서는 주소 체계가 생기면서 여러 통신이 한꺼번에 이루어지는 것을 구분하기 위한 기능이 주로 정의
- 주요 장비로는 네트워크 인터페이스 카드와 스위치(Switch)
  - 2계층의 가장 중요한 특징은 MAC 주소라는 주소 체계가 있음
  - 2계층의 장비들은 모두 MAC 주소를 이해 가능하고, 스위치는 MAC 주소를 보고 통신해야 할 포트를 지정해 보내는 기능이 있음
- 네트워크 인터페이스 카드는 고유 MAC 주소가 있음
  - 입력되는 전기 신호를 데이터 형태로 만들고 데이터에서 도착지 MAC 주소를 확인 후 자신에게 들어오는 신호가 맞는지 확인
  - 자신에게 들어오는 전기 신호가 맞으면 이 데이터를 상위 계층에서 처리 가능하게 메모리에 적재
- 스위치는 단말(Terminal)이 어떤 MAC 주소인지, 연결된 포트는 어느 것인지 주소 습득 과정에서 알 수 있음
  - 이 데이터를 기반으로 단말들이 통신할 때 포트를 적절히 필터링하고 정확한 포트로 포워딩
  - 스위치 덕에 네트워크 전체에 불필요한 처리가 감소하면서 이더넷 네트워크 효율성이 크게 향상되었고 이더넷 기반 네트워크가 급증하는 계기가 됨

### 1.3 3계층(Network Layer)

- IP 주소와 같은 논리적인 주소가 정의
  - 데이터 통신을 할 때는 2계층의 물리적 주소인 MAC 주소와 3계층의 논리적인 IP 주소
  - MAC 주소와 달리 IP 주소는 사용자가 환경에 맞게 변경해 사용 가능하고 네트워크 주소 부분과 호스트 주소 부분으로 나뉨
  - 3계층을 이해 가능한 장비나 단말은 네트워크 주소 정보를 이용해 자신이 속한 네트워크와 원격지 네트워크 구분 가능
  - 원격지 네트워크 가려면 어디로 가야 하는지 경로를 지정하는 능력이 있음
- 3계층에서 동작하는 장비는 라우터
  - 라우터는 3계층에서 정의한 IP 주소 이해 가능
  - 라우터는 IP 주소를 사용해 최적의 경로를 찾아주고 해당 경로로 패킷을 전송하는 역할

### 1.4 4계층(Transport Layer)

- 4계층은 실제로 데이터들이 정상적으로 잘 보내지도록 확인하는 역할을 함
  - 패킷 네트워크는 데이터를 불할해 패킷에 실어보내다 보니 중간에 패킷이 유실되거나 순서가 바뀌는 경우가 생길 수 있음
  - 이 문제를 해결하기 위해 패킷이 유실되거나 순서가 바뀌었을 때 바로 잡아 주는 역할을 4계층에서 담당
- 4계층에서 동작하는 장비는 로드 밸런서와 방화벽
  - 4계층에서 볼 수 있는 애플리케이션 구분자(포트 번호)와 시퀀스, ACK 번호 정보를 이용해 부하 분산이나 보안 정책 수립

### 1.5 5계층(Session Layer)

- 5계층인 세션 계층은 양 끝단의 응용 프로세스가 연결을 성립하도록 도와주고 연결이 안정적으로 유지되도록 관리하고 작업 완료 후에는 이 연결을 끊는 역할을 함
- 흔히 우리가 '세션'을 관리하는 것이 주요 역할인 세션 계층은 TCP/IP 세션을 만들고 없애는 책임을 짐
- 에러로 중단된 통신에 대한 에러 복구와 재전송도 수행

### 1.6 6계층(Presentation Layer)

- 표현 방식이 다른 애플리케이션이나 시스템 간의 통신을 돕기 위해 하나의 통일된 구문 형식으로 반환시키는 기능을 수행
- 일종의 번역기나 변환기 역할을 수행하고 이런 기능은 사용자 시스템의 응용 계층에서 데이터의 형식상 차이를 다루는 부담을 덜어줌
- MIME 인코딩이나 암호화, 압축, 코드 변환과 같은 동작이 이 계층에서 이루어짐

### 1.7 7계층(Application Layer)

- 애플리케이션 프로세스를 정의하고 애플리케이션 서비스를 수행
- 네트워크 소프트웨어의 UI 부분이나 사용자 I/O 부분을 정의하는 것이 역할
- 애플리케이션 게층의 프로토콜을 무수히 많지만 대표적으로 FTP, SMTP, HTTP, TELNET 등이 있음

## 2. TCP/IP 프로토콜 스택

- 현대 네트워크는 대부분 TCP/IP와 이더넷으로 이루어져 있음
- TCP/IP와 이더넷이 개발된 것은 매우 오래전이지만, 기술의 발전으로 현재는 값싸고 성능이 우수한 TCP/IP와 이더넷이 됨
- OSI 모델은 7계층으로 이루어진 반면, TCP.IP 모델은 4계층으로 구분
  - 상위 3개 계층을 Application 계층으로 구분
  - 1, 2계층, 즉 물리, 데이터 링크 계층을 하나의 네트워크 계층으로 구분
  - 3계층은 인터넷으로 구분

## 3. 인캡슐레이션과 디캡슐레이션

- **인캡슐레이션**: 상위 계층에서 하위 계층으로 데이터를 보내는 것. 즉, 데이터를 보내는 과정
- **디캡슐레이션**: 하위 계층에서 상위 계층으로 데이터를 보내는 것. 즉 데이터를 받는 과정
- 현대 네트워크는 대부분 패킷 기반 네트워크
  - 패킷 네트워크는 데이터를 패킷 단위로 쪼개 전송하는데 이런 기법으로 하나의 통신이 회선 전체를 점유하지 않고 동시에 여러 단말이 통신하도록 해줌
  - 데이터를 패킷으로 쪼개고 네트워크를 이용해 목적지로 보내고 받는 쪽에서는 패킷을 다시 큰 데이터 형태로 결합해 사용
- 애플리케이션에서 데이터를 데이터 플로 계층(1~4 계층)으로 내려보내면서 패킷에 데이터를 넣을 수 있도록 분할하는데 이 과정이 인캡슐레이션
- 실제 데이터는 상위 계층에서 하위 계층, 하위 계층에서 상위 계층으로 전달되고 헤더 정보는 각 계층끼리 전달
- 인캡슐레이션 과정에서는 상위 프로토콜이 많아도 문제가 없지만, 디캡슐레이션하는 목적지 쪽에서는 헤더에 아무 정보가 없으면 어떤 상위 프로토콜로 올려보내 주어야 할지 결정 불가능